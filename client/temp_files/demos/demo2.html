<html>
<script src="../../libs/jquery/dist/jquery.min.js"></script>

<!-- Convert into api calls -->
<link rel="stylesheet" type="text/css" href="demo2.css">
<script src="../../../server/binary_heap.js"></script>
<script src="../../../server/graph_definition.js"></script>
<script src="../../../server/astar.js"></script>


<script>

var g;

$(function(){
  $("#toggle").on('click', firstClick)

  function firstClick() {
    $("#toggle").prop('value', 'Add Edges');
    g = new Graph();
    g.addNode(g, obj);
    g.addNode(g, obj2);
    g.addNode(g, obj3);
    g.addNode(g, obj4);
    $( "#codesnip" ).append('g.addNode(g, obj);<br>g.addNode(g, obj2);</br>g.addNode(g, obj3);</br>g.addNode(g, obj4);<br>');
    $("#out").html(show(g));
    $("#idea").prop('src', 'demo2/g_1.png');
    $("#toggle").off('click').on('click', secondClick);
  }

  function secondClick() {
    $("#toggle").prop('value', 'Drop an Edge');
    g.addEdge(g, "RCH122H7", "RCH122H6");
    g.addEdge(g, "RCH122H6", "RCH120S");
    g.addEdge(g, "RCH10000", "RCH120S");
    g.addEdge(g, "RCH10000", "RCH122H6");
    $( "#codesnip" ).append('g.addEdge(g, "RCH122H7", "RCH122H6");<br>g.addEdge(g, "RCH122H6", "RCH120S");<br>g.addEdge(g, "RCH10000", "RCH120S");<br>g.addEdge(g, "RCH10000", "RCH122H6");<br>');
    $("#out").html(show(g));
    $("#idea").prop('src', 'demo2/g_2.png');

    $("#toggle").off('click').on('click', thirdClick);
  }

  function thirdClick() {
    $("#toggle").prop('value', 'Drop a Node');
    g.dropEdge(g, "RCH10000", "RCH120S");
    $( "#codesnip" ).append('g.dropEdge(g, "RCH10000", "RCH120S");<br>');
    $("#out").html(show(g));
    $("#idea").prop('src', 'demo2/g_3.png');

    $("#toggle").off('click').on('click', fourthClick);
  }

  function fourthClick() {
    $("#toggle").prop('value', 'Perform A*');
    g.dropNode(g, "RCH10000");
    $( "#codesnip" ).append('g.dropNode(g, "RCH10000");<br>');
    $("#out").html(show(g));
    $("#idea").prop('src', 'demo2/g_4.png');

    $("#toggle").off('click').on('click', fifthClick);
  }

  function fifthClick() {
    $("#toggle").prop('value', 'Restart');
    $( "#codesnip" ).append('aStar(g, "RCH120S", "RCH122H7");<br>');
    var temp = aStar(g, "RCH120S", "RCH122H7");
    var out = "<b>The best path (by A*) from RCH 120S to RCH 122H7 is: </b><br>";
    $.each(temp.path, function(ind, val){
      out += val;
      if (ind != temp.path.length - 1) {
        out += " -> ";
      }
    });
    out += "<br>with a distance of <b>" + temp.dist + "</b> units.";

    $("#out").html(show(g) + out);
    $("#idea").prop('src', '../images/demo2/g_5.png');
    $("#toggle").off('click').on('click', sixthClick);
  }

  function sixthClick() {
    $("#toggle").prop('value', 'Start Adventure!');
    $( "#codesnip" ).html("<p>var g = new Graph();</p>");
    $("#out").html("<p>This is the state of the graph.</p>");
    $("#idea").prop('src', 'demo2/g_0.png');

    $("#toggle").off('click').on('click', seventhClick);
  }

  function seventhClick() {
    $("#toggle").on('click', firstClick());
  }


  function show(graph){
    var output;
    output = "<p><b>The graph currently has: " + graph._nodeCount + " nodes and " + graph._edgeCount+ " edges.</b><br>";
    output +="<br><b>The nodes are as follows:</b><br>";
    $.each(g._nodes, function(ind,val){
      output += val._id + " at x = " + val._x + " and y = " + val._y + ".<br>";
    });
    output +="<br><b>The edges are as follows:</b><br>";
    $.each(g._adjacency, function(ind,val){
      if (val.length != 0) {
        output += ind + " is connected to ";
        $.each(val, function(i, j){
          output += j.id;
          if(i != val.length - 1){
            output += ", ";
          }
        });
        output += ".<br>";
      }
    });
    output +="</p>";
    return output;
  }
});
</script>

<body>
  <h1>Demo - February 8, 2016</h1>
  <input type="button" id="toggle" value="Start Adventure!"/>

  <img id="idea" src="demo2/g_0.png" style="text-align: center">
  <div class="container">
    <div class="content_output" id="out">
      <p>This is the state of the graph.</p>
    </div>

    <div class="code" id="codesnip">
      <p>var g = new Graph();</p>
    </div>
  </div>
</body>
</html>
