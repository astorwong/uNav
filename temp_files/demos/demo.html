<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <Title> RCH 3rd Floor </Title>
  <link rel="stylesheet" type="text/css" href="demo1.css">
  <script src="../../libs/jquery/dist/jquery.min.js"></script>
  <script src="../../server/jquery.tabletoCSV.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../server/jquery.csv.js"></script>
</head>

<body>
  <div id="container">
    <img src="RCH_01FLR.png" id="myImgId">
    <div id=wrapper>
      <!-- Adding 5 different canvases for each layer of the json utilities. -->
      <canvas id="canvas1" width="1174" height="800"></canvas>
      <canvas id="canvas2" width=1174 height=800></canvas>
      <canvas id="canvas3" width=1174 height=800></canvas>
      <canvas id="canvas4" width=1174 height=800></canvas>
      <canvas id="canvas5" width=1174 height=800></canvas>
    </div>
  </div>

  <div style="background-color:#E8E8E8">
    <!-- Demoing UW API link -->
    <div id="inputs" class="clearfix">
      <select id="sel">
      </select>
    </div>

    <div>
      <!-- This div is for showing the markers on and off from the json file. -->
      <input type="button" id="markers_toggle" value="Show Hallways" />
    </div>
    <output id="list">
    </output>
  </div>

  <script>
  $(function(){
    // all
    var canvas1 = document.getElementById("canvas1");
    // hallways
    var canvas2 = document.getElementById("canvas2");
    // stairs
    var canvas3 = document.getElementById("canvas3");
    // WC
    var canvas4 = document.getElementById("canvas4");
    // Elevator
    var canvas5 = document.getElementById("canvas5");
    // Adding context variables as necessary to draw on the canvas.
    var context1 = canvas1.getContext("2d");
    var context2 = canvas2.getContext("2d");
    var context3 = canvas3.getContext("2d");
    var context4 = canvas4.getContext("2d");
    var context5 = canvas5.getContext("2d");

    // Connecting to JSON from github for geojson coordinates on RCH1stfloor.
    var nodes = $.getJSON( "/api/demo1/", function(data) {
      $.each(data.features, function(i, option) {
        context1.fillStyle="#FF0000";
        context1.fillRect( option.geometry.coordinates[0], option.geometry.coordinates[1], 5, 5 );
        if(option.properties.utility == "Hallway") {
          context2.fillStyle="#FF0000";
          context2.fillRect( option.geometry.coordinates[0], option.geometry.coordinates[1], 10, 10 );
        }
        else if(option.properties.utility == "Stairs") {
          context3.fillStyle="#00FFFF";
          context3.fillRect( option.geometry.coordinates[0], option.geometry.coordinates[1], 10, 10 );
        }
        else if(option.properties.utility == "WC") {
          context4.fillStyle="#0000FF";
          context4.fillRect( option.geometry.coordinates[0], option.geometry.coordinates[1], 10, 10 );
        }
        else if(option.properties.utility == "Elevator") {
          context5.fillStyle="#F000FF";
          context5.fillRect( option.geometry.coordinates[0], option.geometry.coordinates[1], 10, 10 );
        }
      });
    })
  });

  // Function DrawLine for drawing edges onto the map. To be worked out later.
  function drawLine(p1, p2) {
    var canvas1 = document.getElementById('canvas1');
    var context = canvas.getContext('2d');
    context.lineWidth ="5";
    context.strokeStyle="red";
    var jqxhr = $.getJSON( "https://raw.githubusercontent.com/eginwong/uNav/master/coordinates/room_nodes.json?token=AGViNaqNCV-Xe1RPLB_1Gy8sIgc0UHW7ks5WrtQNwA%3D%3D", function(data) {
      // var jqxhr = $.getJSON( "https://raw.githubusercontent.com/eginwong/uNav/master/geojson_ex.json?token=AGViNf2Dc0xvxTq2dPBIKQBqovSHPlInks5Wq6zMwA%3D%3D", function(data) {
      console.log(data);
      // console.log(data.features[0].properties);
    });
    // $.each(arrayCoord, function(i, coord) {
    //   if (i == 0) {
    //     context.moveTo(coord.x,coord.y);//120_stair
    //   }
    //   else{
    //     context.lineTo(coord.x,coord.y);//119a_hallway
    //   }
    // });
    // context.stroke();
  }
  // This function will show or hide markers depending on utility and options passed.
  function show_hide(canvasnum){
    for (i=1; i < 6;i++) {
      if (i == canvasnum) {
        var canvas = document.getElementById('canvas'+i);
        var context = canvas.getContext('2d');
        canvas.style.visibility='visible';
      }
      else{
        var canvas = document.getElementById('canvas'+i);
        var context = canvas.getContext('2d');
        canvas.style.visibility='hidden';
      }
    }
  }

  // Whole javascript switch click going on here to show different prompts for each utility.
  $("#markers_toggle").on('click', firstClick)
  function firstClick() {
    $("#markers_toggle").prop('value', 'Show Stairs');
    show_hide(2);
    $("#markers_toggle").off('click').on('click', secondClick);
  }
  function secondClick() {
    $("#markers_toggle").prop('value', 'Show Washrooms');
    show_hide(3);
    $("#markers_toggle").off('click').on('click', thirdClick);
  }
  function thirdClick() {
    $("#markers_toggle").prop('value', 'Show Elevators');
    show_hide(4);
    $("#markers_toggle").off('click').on('click', fourthClick);
  }
  function fourthClick() {
    $("#markers_toggle").prop('value', 'Show All');
    show_hide(5);
    $("#markers_toggle").off('click').on('click', fifthClick);
  }
  function fifthClick() {
    $("#markers_toggle").prop('value', 'Show Hallways');
    show_hide(1);
    $("#markers_toggle").off('click').on('click', firstClick);
  }
  </script>
</body>
</html>
